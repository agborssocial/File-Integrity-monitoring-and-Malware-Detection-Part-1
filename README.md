# Understanding and Setting Up Wazuh Capabilities - Part 1

## Objective
This lab aims to configure and utilize Wazuh's File Integrity Monitoring (FIM) to track unauthorized changes to critical files, deploy malware detection mechanisms through file hash checks and integration with third-party threat detection platforms like VirusTotal, and configure rootkit detection to identify and mitigate potential rootkit and trojan threats. The objective is to gain a comprehensive understanding of how Wazuh can be leveraged to provide robust security monitoring and incident response capabilities across all endpoints within a network.

## Lab Setup
The lab consists of two Virtual Machines (VMs). The Wazuh server is installed on an Ubuntu VM, and the agent is installed on a Windows VM. VMware is used as the virtualization platform.

### Skills Learned
- Creating and managing FIM rules to detect file modifications and creations that might indicate security breaches or malware behavior.
- Integrating Wazuh with external platforms like VirusTotal for enhanced malware detection.
- Collecting and analyzing logs from various sources, including Windows Defender, to detect potential threats and vulnerabilities.
- Deploying and managing Wazuh in a network environment, including tasks such as configuring agents, managing policies, and troubleshooting issues.
- Proficiency in analyzing and interpreting network logs.

### Tools Used
- Wazuh
- VMware

### Steps
## File Integrity Monitoring (FIM)
Wazuh File Integrity Monitoring (FIM) is managed by the Wazuh FIM module, which is enabled by default. However, some changes to the configuration file are necessary to specify the directories to scan and the scan frequency. In this lab, the directories to be monitored are the Downloads and Desktop directories. Since the Wazuh agent is installed on a Windows endpoint, the configuration file is located at `C:\Program Files (x86)\ossec-agent\ossec.conf`.

### Use Case: Setting Up Wazuh FIM Module to Scan Downloads and Desktop Directories

1. **Backup the Configuration File**  
   Navigate to `C:\Program Files (x86)\ossec-agent\ossec.conf` using Windows File Explorer. Copy and paste the configuration file in the same directory. Rename the copied file to `ossec-original.conf` to mark it as the original or default configuration file.

2. **Configure the FIM Module**  
   Open Notepad with administrator privileges. Use the File menu to navigate to the specified directory and open the `ossec.conf` file. Change the file type in the dialog box from `.txt` to "All Files." Use the Find function and search for "File integrity monitoring." This will highlight the FIM module configuration section. Below the `<disabled>no</disabled>` tag, add the following lines, ensuring proper spacing:
   ```xml
   <directories>C:\Users\<YOUR USERNAME>\Downloads</directories>
   <directories>C:\Users\<YOUR USERNAME>\Desktop</directories>
